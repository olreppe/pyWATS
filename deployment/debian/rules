#!/usr/bin/make -f

# Debian build rules for pywats-client

%:
	dh $@ --with python3 --buildsystem=pybuild

override_dh_auto_build:
	dh_auto_build
	# Build Python package
	python3 -m pip wheel --no-deps --wheel-dir=debian/tmp/wheels .

override_dh_auto_install:
	dh_auto_install
	# Install Python package
	python3 -m pip install --prefix=/usr --root=debian/pywats-client debian/tmp/wheels/*.whl
	# Install systemd service file
	install -D -m 644 debian/pywats-client.service debian/pywats-client/lib/systemd/system/pywats-client.service
	# Create data directories
	install -d -m 755 debian/pywats-client/var/lib/pywats
	install -d -m 755 debian/pywats-client/var/log/pywats
	install -d -m 755 debian/pywats-client/etc/pywats

override_dh_installsystemd:
	dh_installsystemd --name=pywats-client

override_dh_auto_test:
	# Skip tests during package build
	@echo "Skipping tests during package build"
