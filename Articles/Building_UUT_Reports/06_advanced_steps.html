<!-- KEYWORDS: multi-numeric, chart, graph, MultipleNumericLimitStep, AddChart, visualization, multiple measurements, I-V curve -->

<h2 id="h_01K9QH6A1B2C3D4E5F6G7H8I9J">Multi-Numeric Limit Steps</h2>
<p>
    Multi-Numeric Limit Steps allow you to record multiple related measurements in a single step. This is useful for
    tests that produce multiple values that should be viewed together, such as I-V curves, frequency sweeps, or
    multi-channel measurements.
</p>

<h2 id="h_01K9QH6A1B2C3D4E5F6G7H8I9K">Creating a Multi-Numeric Step</h2>
<pre class="wysiwyg-code-block"><code class="language-auto">// Add a multi-numeric step
MultipleNumericLimitStep powerStep = rootSeq.AddMultipleNumericLimitStep("Power Supply Test");

// Add multiple measurements
powerStep.AddTest(
    measurement: 5.02,
    compOperator: CompOperatorType.GELE,
    lowLimit: 4.90,
    highLimit: 5.10,
    unit: "V",
    name: "5V Rail",
    status: StepStatusType.Passed
);

powerStep.AddTest(
    measurement: 3.31,
    compOperator: CompOperatorType.GELE,
    lowLimit: 3.20,
    highLimit: 3.40,
    unit: "V",
    name: "3.3V Rail",
    status: StepStatusType.Passed
);

powerStep.AddTest(
    measurement: 1.79,
    compOperator: CompOperatorType.GELE,
    lowLimit: 1.70,
    highLimit: 1.90,
    unit: "V",
    name: "1.8V Rail",
    status: StepStatusType.Passed
);</code></pre>

<p>
    <strong>Note:</strong> The overall step status is typically set based on whether all measurements passed.
</p>

<h2 id="h_01K9QH6A1B2C3D4E5F6G7H8I9L">Chart Steps</h2>
<p>
    Chart steps are a specialized type of multi-numeric step that displays data as a chart in WATS. You can add a chart
    to any step type or use a dedicated chart step.
</p>

<h3 id="h_01K9QH6A1B2C3D4E5F6G7H8I9M">Method 1: Chart as Attachment (Any Step Type)</h3>
<p>
    You can attach chart data to any existing step:
</p>
<pre class="wysiwyg-code-block"><code class="language-auto">// Create a regular step
NumericLimitStep frequencyResponse = rootSeq.AddNumericLimitStep("Frequency Response");
frequencyResponse.AddTest(0.95, CompOperatorType.GE, 0.90, 0.0, "dB", StepStatusType.Passed);

// Create chart data
List<double> xValues = new List<double> { 100, 200, 500, 1000, 2000, 5000, 10000 };
List<double> yValues = new List<double> { -0.1, -0.2, -0.3, -0.5, -0.8, -1.2, -3.0 };

// Add chart attachment
frequencyResponse.AddChart(
    name: "Frequency Response Curve",
    xAxisLabel: "Frequency (Hz)",
    yAxisLabel: "Gain (dB)",
    xValues: xValues.ToArray(),
    yValues: yValues.ToArray()
);</code></pre>

<h3 id="h_01K9QH6A1B2C3D4E5F6G7H8I9N">Method 2: Dedicated Chart Step (Multi-Numeric with Chart)</h3>
<p>
    A chart step is essentially a multi-numeric step with automatic chart visualization. The key difference is that WATS
    displays it with a chart icon.
</p>
<pre class="wysiwyg-code-block"><code class="language-auto">// Add a multi-numeric step for chart data
MultipleNumericLimitStep chartStep = rootSeq.AddMultipleNumericLimitStep("I-V Curve");

// Add data points
double[] voltages = { 0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0 };
double[] currents = { 0.0, 5.2, 10.5, 15.8, 21.1, 26.3, 31.5 };

for (int i = 0; i < voltages.Length; i++)
{
    chartStep.AddTest(
        measurement: currents[i],
        compOperator: CompOperatorType.NONE,
        lowLimit: 0.0,
        highLimit: 0.0,
        unit: "mA",
        name: $"I @ {voltages[i]}V",
        status: StepStatusType.Done
    );
}

// Add chart visualization
chartStep.AddChart(
    name: "I-V Characteristic",
    xAxisLabel: "Voltage (V)",
    yAxisLabel: "Current (mA)",
    xValues: voltages,
    yValues: currents
);

// Set overall step status
chartStep.Status = StepStatusType.Passed;</code></pre>

<h2 id="h_01K9QH6A1B2C3D4E5F6G7H8I9O">Multiple Charts on One Step</h2>
<p>
    You can add multiple charts to a single step:
</p>
<pre class="wysiwyg-code-block"><code class="language-auto">MultipleNumericLimitStep waveformStep = rootSeq.AddMultipleNumericLimitStep("Signal Analysis");

// Add measurements
// ... (add numeric measurements)

// Add multiple charts
double[] timePoints = { 0.0, 0.001, 0.002, 0.003, 0.004, 0.005 };
double[] channel1 = { 0.0, 1.2, 2.3, 1.8, 0.5, 0.0 };
double[] channel2 = { 0.0, -0.5, -1.1, -0.8, -0.3, 0.0 };

waveformStep.AddChart("Channel 1", "Time (s)", "Voltage (V)", timePoints, channel1);
waveformStep.AddChart("Channel 2", "Time (s)", "Voltage (V)", timePoints, channel2);</code></pre>

<h2 id="h_01K9QH6A1B2C3D4E5F6G7H8I9P">Chart Best Practices</h2>
<ul>
    <li>Use descriptive chart names and axis labels</li>
    <li>Include units in axis labels</li>
    <li>Keep chart data arrays synchronized (same length for X and Y)</li>
    <li>Use multi-numeric steps when you want to see both tabular data and charts</li>
    <li>Limit chart data points to reasonable amounts (typically &lt; 10,000 points)</li>
</ul>

<h2 id="h_01K9QH6A1B2C3D4E5F6G7H8I9Q">Complete Example with Charts</h2>
<pre class="wysiwyg-code-block"><code class="language-auto">using System.Collections.Generic;
using Virinco.WATS.Interface;

// Get root sequence
SequenceCall rootSeq = uut.GetRootSequenceCall();

// Create multi-numeric step with chart
MultipleNumericLimitStep powerAnalysis = rootSeq.AddMultipleNumericLimitStep("Power Analysis");

// Add measurements
powerAnalysis.AddTest(5.02, CompOperatorType.GELE, 4.90, 5.10, "V", "5V Rail", StepStatusType.Passed);
powerAnalysis.AddTest(3.31, CompOperatorType.GELE, 3.20, 3.40, "V", "3.3V Rail", StepStatusType.Passed);
powerAnalysis.AddTest(125.5, CompOperatorType.LE, 0.0, 150.0, "mA", "Total Current", StepStatusType.Passed);

// Add chart showing power-up sequence
double[] timeMs = { 0, 10, 20, 30, 40, 50 };
double[] voltage5V = { 0.0, 2.5, 4.2, 4.9, 5.0, 5.02 };

powerAnalysis.AddChart(
    name: "Power-Up Sequence",
    xAxisLabel: "Time (ms)",
    yAxisLabel: "5V Rail Voltage (V)",
    xValues: timeMs,
    yValues: voltage5V
);

powerAnalysis.Status = StepStatusType.Passed;</code></pre>