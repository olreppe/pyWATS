<!DOCTYPE html><html><head>
      <title>COMPONENT_DIAGRAMS</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="file:///c:\Users\ola.lund.reppe\.vscode\extensions\shd101wyy.markdown-preview-enhanced-0.8.20\crossnote\dependencies\katex\katex.min.css">
      
      
      <script type="text/javascript" src="file:///c:\Users\ola.lund.reppe\.vscode\extensions\shd101wyy.markdown-preview-enhanced-0.8.20\crossnote\dependencies\mermaid\mermaid.min.js" charset="UTF-8"></script>
      
      
      <style>
      code[class*=language-],pre[class*=language-]{color:#333;background:0 0;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.4;-moz-tab-size:8;-o-tab-size:8;tab-size:8;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:.8em;overflow:auto;border-radius:3px;background:#f5f5f5}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal;background:#f5f5f5}.token.blockquote,.token.comment{color:#969896}.token.cdata{color:#183691}.token.doctype,.token.macro.property,.token.punctuation,.token.variable{color:#333}.token.builtin,.token.important,.token.keyword,.token.operator,.token.rule{color:#a71d5d}.token.attr-value,.token.regex,.token.string,.token.url{color:#183691}.token.atrule,.token.boolean,.token.code,.token.command,.token.constant,.token.entity,.token.number,.token.property,.token.symbol{color:#0086b3}.token.prolog,.token.selector,.token.tag{color:#63a35c}.token.attr-name,.token.class,.token.class-name,.token.function,.token.id,.token.namespace,.token.pseudo-class,.token.pseudo-element,.token.url-reference .token.variable{color:#795da3}.token.entity{cursor:help}.token.title,.token.title .token.punctuation{font-weight:700;color:#1d3e81}.token.list{color:#ed6a43}.token.inserted{background-color:#eaffea;color:#55a532}.token.deleted{background-color:#ffecec;color:#bd2c00}.token.bold{font-weight:700}.token.italic{font-style:italic}.language-json .token.property{color:#183691}.language-markup .token.tag .token.punctuation{color:#333}.language-css .token.function,code.language-css{color:#0086b3}.language-yaml .token.atrule{color:#63a35c}code.language-yaml{color:#183691}.language-ruby .token.function{color:#333}.language-markdown .token.url{color:#795da3}.language-makefile .token.symbol{color:#795da3}.language-makefile .token.variable{color:#183691}.language-makefile .token.builtin{color:#0086b3}.language-bash .token.keyword{color:#0086b3}pre[data-line]{position:relative;padding:1em 0 1em 3em}pre[data-line] .line-highlight-wrapper{position:absolute;top:0;left:0;background-color:transparent;display:block;width:100%}pre[data-line] .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:hsla(24,20%,50%,.08);background:linear-gradient(to right,hsla(24,20%,50%,.1) 70%,hsla(24,20%,50%,0));pointer-events:none;line-height:inherit;white-space:pre}pre[data-line] .line-highlight:before,pre[data-line] .line-highlight[data-end]:after{content:attr(data-start);position:absolute;top:.4em;left:.6em;min-width:1em;padding:0 .5em;background-color:hsla(24,20%,50%,.4);color:#f4f1ef;font:bold 65%/1.5 sans-serif;text-align:center;vertical-align:.3em;border-radius:999px;text-shadow:none;box-shadow:0 1px #fff}pre[data-line] .line-highlight[data-end]:after{content:attr(data-end);top:auto;bottom:.4em}html body{font-family:'Helvetica Neue',Helvetica,'Segoe UI',Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ol,html body>ul{margin-bottom:16px}html body ol,html body ul{padding-left:2em}html body ol.no-list,html body ul.no-list{padding:0;list-style-type:none}html body ol ol,html body ol ul,html body ul ol,html body ul ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:700;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::after,html body code::before{letter-spacing:-.2em;content:'\00a0'}html body pre>code{padding:0;margin:0;word-break:normal;white-space:pre;background:0 0;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:after,html body pre code:before,html body pre tt:after,html body pre tt:before{content:normal}html body blockquote,html body dl,html body ol,html body p,html body pre,html body ul{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body code,html body pre{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview ul{list-style:disc}.markdown-preview ul ul{list-style:circle}.markdown-preview ul ul ul{list-style:square}.markdown-preview ol{list-style:decimal}.markdown-preview ol ol,.markdown-preview ul ol{list-style-type:lower-roman}.markdown-preview ol ol ol,.markdown-preview ol ul ol,.markdown-preview ul ol ol,.markdown-preview ul ul ol{list-style-type:lower-alpha}.markdown-preview .newpage,.markdown-preview .pagebreak{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center!important}.markdown-preview:not([data-for=preview]) .code-chunk .code-chunk-btn-group{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .status{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .output-div{margin-bottom:16px}.markdown-preview .md-toc{padding:0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link div,.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}.markdown-preview .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0;min-height:100vh}@media screen and (min-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{font-size:14px!important;padding:1em}}@media print{html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc{padding:0 16px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link div,html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% - 300px);padding:2em calc(50% - 457px - 300px / 2);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
      <!-- The content below will be included at the end of the <head> element. --><script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function () {
    // your code here
  });
</script></head><body for="html-export">
    
    
      <div class="crossnote markdown-preview  ">
      
<h1 id="component-diagrams—api-client-ui-architecture">Component Diagrams - API-Client-UI Architecture </h1>
<p><strong>Date:</strong> February 8, 2026</p>
<p>This document contains comprehensive component diagrams showing class hierarchies, system architecture, and component relationships.</p>
<hr>
<h2 id="1-three-layer-system-architecture">1. Three-Layer System Architecture </h2>
<div class="mermaid">C4Context
    title System Context - pyWATS Three-Layer Architecture

    Person(user, "User", "Test engineer or operator")
    
    System_Boundary(pyWATS, "pyWATS System") {
        Container(ui, "UI Layer", "PySide6", "GUI applications for configuration and monitoring")
        Container(client, "Client Layer", "Python Service", "Background service for file monitoring and queue management")
        Container(api, "API Layer", "Python Library", "Synchronous API wrapper for WATS server")
    }
    
    System_Ext(wats, "WATS Server", "Test data management server")
    System_Ext(cfx, "IPC-CFX Devices", "Manufacturing equipment")
    
    Rel(user, ui, "Interacts with", "Qt GUI")
    Rel(ui, client, "Events, IPC", "Qt Signals, Named Pipes")
    Rel(client, api, "API Calls", "Function calls")
    Rel(api, wats, "HTTP REST", "JSON over HTTPS")
    Rel(cfx, client, "Test Results", "IPC-CFX protocol")
</div><hr>
<h2 id="2-layer-component-view">2. Layer Component View </h2>
<div class="mermaid">graph TB
    subgraph UI["UI Layer (pywats_ui)"]
        Configurator[Configurator App]
        YieldMonitor[Yield Monitor App]
        Framework[UI Framework]
        
        Configurator --&gt; Framework
        YieldMonitor --&gt; Framework
        
        subgraph FrameworkComponents["Framework Components"]
            BasePage[BasePage]
            ErrorMixin[ErrorHandlingMixin]
            AsyncRunner[AsyncTaskRunner]
            APIRunner[AsyncAPIRunner]
        end
        
        Framework --&gt; FrameworkComponents
    end
    
    subgraph Client["Client Layer (pywats_client)"]
        ClientService[Client Service]
        ConfigMgr[Config Manager]
        QueueMgr[Queue Manager]
        AppEventBus["Application EventBus&lt;br/&gt;(Qt Signals)"]
        IPCServer[IPC Server]
        
        ClientService --&gt; ConfigMgr
        ClientService --&gt; QueueMgr
        ClientService --&gt; AppEventBus
        ClientService --&gt; IPCServer
    end
    
    subgraph API["API Layer (pywats)"]
        PyWATS[pyWATS Class]
        AsyncClient[AsyncHttpClient]
        DomainServices[Domain Services]
        CoreExceptions[Core Exceptions]
        CoreLogging[Core Logging]
        
        PyWATS --&gt; AsyncClient
        PyWATS --&gt; DomainServices
        DomainServices --&gt; AsyncClient
        DomainServices --&gt; CoreExceptions
        DomainServices --&gt; CoreLogging
    end
    
    subgraph Events["Event Infrastructure (pywats_events)"]
        ProtocolBus[Protocol EventBus]
        Handlers[Event Handlers]
        Transports[Transports&lt;br/&gt;CFX, MQTT]
        
        Transports --&gt; ProtocolBus
        ProtocolBus --&gt; Handlers
    end
    
    UI --&gt;|Qt Signals,&lt;br/&gt;IPC| Client
    Client --&gt;|Function Calls| API
    Client -.-&gt;|Optional| Events
    Handlers -.-&gt;|Can trigger| AppEventBus
    
    style UI fill:#e1f5fe
    style Client fill:#fff3e0
    style API fill:#f3e5f5
    style Events fill:#e8f5e9
</div><hr>
<h2 id="3-class-hierarchy—api-layer">3. Class Hierarchy - API Layer </h2>
<div class="mermaid">classDiagram
    class pyWATS {
        -AsyncHttpClient _http_client
        -Station _station
        -SyncConfig _sync_config
        +property report : SyncServiceWrapper
        +property product : SyncServiceWrapper
        +property asset : SyncServiceWrapper
        +test_connection() bool
        +close()
        +__enter__() pyWATS
        +__exit__()
    }
    
    class AsyncHttpClient {
        -str _base_url
        -str _token
        -ClientSession _session
        -RetryConfig _retry_config
        +async get(endpoint) dict
        +async post(endpoint, data) dict
        +async patch(endpoint, data) dict
        +async delete(endpoint) dict
        +async close()
    }
    
    class SyncServiceWrapper {
        -AsyncService _async_service
        -SyncConfig _config
        +__getattr__(name) method
        -_wrap_async(coro) result
    }
    
    class AsyncReportService {
        -AsyncHttpClient _client
        +async list(filters) List~Report~
        +async get(id) Report
        +async create(report) Report
        +async upload_file(file) str
    }
    
    class AsyncProductService {
        -AsyncHttpClient _client
        +async list() List~Product~
        +async get(id) Product
        +async search(query) List~Product~
    }
    
    class PyWATSError {
        +str error_type
        +str message
        +dict details
    }
    
    class AuthenticationError {
        +str auth_method
    }
    
    class NotFoundError {
        +str resource_type
        +str resource_id
    }
    
    class ValidationError {
        +dict validation_errors
    }
    
    pyWATS --&gt; AsyncHttpClient : uses
    pyWATS --&gt; SyncServiceWrapper : creates
    SyncServiceWrapper --&gt; AsyncReportService : wraps
    SyncServiceWrapper --&gt; AsyncProductService : wraps
    AsyncReportService --&gt; AsyncHttpClient : uses
    AsyncProductService --&gt; AsyncHttpClient : uses
    
    PyWATSError &lt;|-- AuthenticationError
    PyWATSError &lt;|-- NotFoundError
    PyWATSError &lt;|-- ValidationError
    
    AsyncReportService --&gt; PyWATSError : raises
    AsyncProductService --&gt; PyWATSError : raises
</div><hr>
<h2 id="4-class-hierarchy—client-layer">4. Class Hierarchy - Client Layer </h2>
<div class="mermaid">classDiagram
    class ClientService {
        -AsyncClientService _async
        -EventLoop _loop
        +instance_id : str
        +config : ClientConfig
        +status : ServiceStatus
        +start()
        +stop()
        +get_stats() dict
    }
    
    class AsyncClientService {
        -str _instance_id
        -ClientConfig _config
        -pyWATS _api
        -QueueManager _queue
        -PendingWatcher _watcher
        -AsyncServiceStatus _status
        +async run()
        +async stop()
        +async _initialize_api()
        +async _process_queue()
    }
    
    class ApplicationEventBus {
        &lt;&lt;singleton&gt;&gt;
        -dict _subscribers
        +Signal connection_changed
        +Signal api_client_ready
        +publish(event, **data)
        +subscribe(event, callback)
        +unsubscribe(event, callback)
    }
    
    class AppEvent {
        &lt;&lt;enumeration&gt;&gt;
        CONNECTION_CHANGED
        API_CLIENT_READY
        QUEUE_STATUS_CHANGED
        CONFIG_CHANGED
        APP_ERROR
    }
    
    class QueueManager {
        -Path _queue_dir
        -Path _fallback_dir
        -dict _pending
        +async enqueue(report) str
        +async mark_processed(op_id)
        +async mark_failed(op_id)
        +get_status() QueueStatus
    }
    
    class ClientConfig {
        +str instance_name
        +str server_url
        +str api_token
        +bool auto_connect
        +str log_level
        +save()
        +load() ClientConfig
    }
    
    class ClientError {
        +str error_type
        +str message
    }
    
    class QueueCriticalError {
        +Exception primary_error
        +Exception fallback_error
        +str operation_id
    }
    
    ClientService --&gt; AsyncClientService : wraps
    AsyncClientService --&gt; ApplicationEventBus : publishes to
    AsyncClientService --&gt; QueueManager : uses
    AsyncClientService --&gt; ClientConfig : uses
    AsyncClientService --&gt; pyWATS : creates
    
    ApplicationEventBus --&gt; AppEvent : uses
    QueueManager --&gt; QueueCriticalError : raises
    ClientError &lt;|-- QueueCriticalError
</div><hr>
<h2 id="5-class-hierarchy—ui-framework">5. Class Hierarchy - UI Framework </h2>
<div class="mermaid">classDiagram
    class QWidget {
        &lt;&lt;Qt&gt;&gt;
        +show()
        +hide()
        +setEnabled(bool)
    }
    
    class BasePage {
        -ClientConfig config
        -AsyncTaskRunner _async_runner
        -List~tuple~ _event_subscriptions
        +Signal config_changed
        +Signal loading_changed
        +property page_title : str
        +run_async(coro, name)
        +subscribe_event(event, callback)
        +save_config()
        +load_config()
    }
    
    class ErrorHandlingMixin {
        +handle_error(error, context)
        +show_success(message)
        +show_warning(message)
        +show_error(message)
        +confirm_action(message) bool
    }
    
    class AsyncTaskRunner {
        -QThreadPool _thread_pool
        -dict _tasks
        +Signal task_started
        +Signal task_finished
        +submit_task(coro, name) str
        +cancel_task(task_id) bool
        +get_status(task_id) TaskStatus
    }
    
    class TaskResult {
        +bool success
        +Any data
        +Exception error
        +str task_id
        +str name
    }
    
    class AsyncAPIRunner {
        -pyWATS _api_client
        -AsyncTaskRunner _runner
        +run(coro, on_complete)
        +get_product(id, callback)
        +list_reports(filters, callback)
    }
    
    class SetupPage {
        -QLineEdit server_url_input
        -QLineEdit api_token_input
        +save_config()
        +load_config()
        +_on_test_connection()
    }
    
    class ReportsPage {
        -QTableWidget reports_table
        -QComboBox filter_combo
        +load_config()
        +_on_refresh()
        +_load_reports()
        +_on_reports_loaded(reports)
    }
    
    QWidget &lt;|-- BasePage
    BasePage &lt;|-- ErrorHandlingMixin : mixin
    BasePage --&gt; AsyncTaskRunner : uses
    BasePage --&gt; TaskResult : receives
    
    AsyncAPIRunner --&gt; AsyncTaskRunner : uses
    AsyncAPIRunner --&gt; pyWATS : wraps
    
    BasePage &lt;|-- SetupPage
    BasePage &lt;|-- ReportsPage
</div><hr>
<h2 id="6-event-system-architecture">6. Event System Architecture </h2>
<div class="mermaid">graph TB
    subgraph AppEventSystem["Application Event System (Qt-based)"]
        AppBus["ApplicationEventBus&lt;br/&gt;(Singleton)"]
        
        subgraph Publishers["Publishers"]
            ClientSvc[Client Service]
            UIPagesP[UI Pages]
        end
        
        subgraph Subscribers["Subscribers"]
            UIPagesS[UI Pages]
            OtherSvc[Other Services]
        end
        
        Publishers --&gt;|publish| AppBus
        AppBus --&gt;|Qt Signal| Subscribers
    end
    
    subgraph ProtocolEventSystem["Protocol Event System"]
        ProtoBus[Protocol EventBus]
        
        subgraph TransportLayer["Transports"]
            CFX[CFX Transport]
            MQTT[MQTT Transport]
            WebHook[WebHook Transport]
        end
        
        subgraph HandlerLayer["Handlers"]
            TestHandler[TestResultHandler]
            StatusHandler[StatusHandler]
            CustomHandler[Custom Handlers]
        end
        
        TransportLayer --&gt;|publish events| ProtoBus
        ProtoBus --&gt;|route to| HandlerLayer
    end
    
    HandlerLayer -.-&gt;|can trigger| AppBus
    
    style AppEventSystem fill:#e1f5fe
    style ProtocolEventSystem fill:#e8f5e9
    style AppBus fill:#81d4fa
    style ProtoBus fill:#a5d6a7
</div><hr>
<h2 id="7-event-type-hierarchy">7. Event Type Hierarchy </h2>
<div class="mermaid">graph LR
    subgraph ApplicationEvents["Application Events (Qt)"]
        AE1[CONNECTION_CHANGED&lt;br/&gt;status: str]
        AE2[API_CLIENT_READY&lt;br/&gt;client: pyWATS]
        AE3[QUEUE_STATUS_CHANGED&lt;br/&gt;pending: int, failed: int]
        AE4[CONFIG_CHANGED&lt;br/&gt;key: str, value: Any]
        AE5[APP_ERROR&lt;br/&gt;error: str]
    end
    
    subgraph ProtocolEvents["Protocol Events"]
        PE1[TEST_RESULT&lt;br/&gt;unit_id, result, data]
        PE2[UNIT_STATUS_CHANGED&lt;br/&gt;unit_id, status]
        PE3[STATION_STATUS&lt;br/&gt;station_id, status]
        PE4[RESOURCE_UPDATED&lt;br/&gt;resource_type, id]
    end
    
    subgraph EventFlow["Event Flow"]
        UI[UI Pages] --&gt;|subscribe| AE1
        UI --&gt;|subscribe| AE2
        UI --&gt;|subscribe| AE3
        UI --&gt;|subscribe| AE4
        
        Service[Client Service] --&gt;|publish| AE1
        Service --&gt;|publish| AE2
        Service --&gt;|publish| AE3
        
        Devices[Manufacturing Devices] --&gt;|produce| PE1
        Devices --&gt;|produce| PE2
        
        Handlers[Domain Handlers] --&gt;|process| PE1
        Handlers --&gt;|process| PE2
        Handlers -.-&gt;|can trigger| AE4
    end
    
    style ApplicationEvents fill:#fff3e0
    style ProtocolEvents fill:#f3e5f5
</div><hr>
<h2 id="8-logging-architecture">8. Logging Architecture </h2>
<div class="mermaid">graph TB
    subgraph RootLogger["Root Logger Hierarchy"]
        Root[root]
        
        subgraph APILoggers["pywats.*"]
            APIRoot[pywats]
            APIReport[pywats.domains.report]
            APIProduct[pywats.domains.product]
            APIClient[pywats.core.async_client]
            APICache[pywats.core.cache]
            
            APIRoot --&gt; APIReport
            APIRoot --&gt; APIProduct
            APIRoot --&gt; APIClient
            APIRoot --&gt; APICache
        end
        
        subgraph ClientLoggers["pywats_client.*"]
            ClientRoot[pywats_client]
            ClientService[pywats_client.service]
            ClientQueue[pywats_client.core.queue_manager]
            ClientEventBus[pywats_client.core.event_bus]
            
            ClientRoot --&gt; ClientService
            ClientRoot --&gt; ClientQueue
            ClientRoot --&gt; ClientEventBus
        end
        
        subgraph UILoggers["pywats_ui.*"]
            UIRoot[pywats_ui]
            UIFramework[pywats_ui.framework.base_page]
            UIApps[pywats_ui.apps.configurator]
            
            UIRoot --&gt; UIFramework
            UIRoot --&gt; UIApps
        end
        
        subgraph EventLoggers["pywats_events.*"]
            EventRoot[pywats_events]
            EventBus[pywats_events.bus.event_bus]
            EventHandlers[pywats_events.handlers]
            
            EventRoot --&gt; EventBus
            EventRoot --&gt; EventHandlers
        end
        
        Root --&gt; APIRoot
        Root --&gt; ClientRoot
        Root --&gt; UIRoot
        Root --&gt; EventRoot
    end
    
    subgraph LogDestinations["Log Destinations"]
        Console[Console Handler&lt;br/&gt;sys.stdout]
        ServiceLog[Service File Handler&lt;br/&gt;/ProgramData/pyWATS/pywats.log]
        ConversionLogs[Conversion Log Directory&lt;br/&gt;/ProgramData/pyWATS/conversion_logs/]
    end
    
    APIRoot -.-&gt;|development| Console
    ClientRoot --&gt;|production| ServiceLog
    ClientRoot --&gt;|converters| ConversionLogs
    UIRoot -.-&gt;|inherits| ClientRoot
    
    style APILoggers fill:#f3e5f5
    style ClientLoggers fill:#fff3e0
    style UILoggers fill:#e1f5fe
    style EventLoggers fill:#e8f5e9
</div><hr>
<h2 id="9-exception-hierarchy">9. Exception Hierarchy </h2>
<div class="mermaid">graph TB
    Exception[Exception&lt;br/&gt;Python built-in]
    
    subgraph APIExceptions["API Layer Exceptions"]
        PyWATSError[PyWATSError&lt;br/&gt;Base for all API errors]
        AuthError[AuthenticationError&lt;br/&gt;401 responses]
        AuthzError[AuthorizationError&lt;br/&gt;403 responses]
        ValidationError[ValidationError&lt;br/&gt;400 responses]
        NotFoundError[NotFoundError&lt;br/&gt;404 responses]
        ConflictError[ConflictError&lt;br/&gt;409 responses]
        ServerError[ServerError&lt;br/&gt;500 responses]
        ConnError[ConnectionError&lt;br/&gt;Network issues]
        TimeoutError[TimeoutError&lt;br/&gt;Request timeout]
        WatsAPIError[WatsApiError&lt;br/&gt;API-specific]
        EmptyResp[EmptyResponseError]
        InvalidResp[InvalidResponseError]
    end
    
    subgraph ClientExceptions["Client Layer Exceptions"]
        ClientError[ClientError&lt;br/&gt;Base for client errors]
        ConfigError[ConfigurationError&lt;br/&gt;Config issues]
        ServiceError[ServiceError&lt;br/&gt;Service lifecycle]
        QueueError[QueueCriticalError&lt;br/&gt;Double failure]
        ConverterError[ConverterError&lt;br/&gt;Conversion issues]
    end
    
    Exception --&gt; PyWATSError
    PyWATSError --&gt; AuthError
    PyWATSError --&gt; AuthzError
    PyWATSError --&gt; ValidationError
    PyWATSError --&gt; NotFoundError
    PyWATSError --&gt; ConflictError
    PyWATSError --&gt; ServerError
    PyWATSError --&gt; ConnError
    PyWATSError --&gt; TimeoutError
    PyWATSError --&gt; WatsAPIError
    WatsAPIError --&gt; EmptyResp
    WatsAPIError --&gt; InvalidResp
    
    Exception --&gt; ClientError
    ClientError --&gt; ConfigError
    ClientError --&gt; ServiceError
    ClientError --&gt; QueueError
    ClientError --&gt; ConverterError
    
    style PyWATSError fill:#f3e5f5
    style ClientError fill:#fff3e0
    style QueueError fill:#ffcdd2
</div><hr>
<h2 id="10-dependency-graph">10. Dependency Graph </h2>
<div class="mermaid">graph TB
    subgraph Applications["Applications"]
        Configurator[Configurator GUI]
        YieldMon[Yield Monitor]
        PkgMgr[Package Manager]
    end
    
    subgraph UIFramework["UI Framework"]
        BasePage
        ErrorMixin[ErrorHandlingMixin]
        AsyncRunner[AsyncTaskRunner]
    end
    
    subgraph ClientCore["Client Core"]
        ClientService
        EventBus[Application EventBus]
        QueueManager
        ConfigManager
    end
    
    subgraph APICore["API Core"]
        PyWATS
        AsyncHttpClient
        DomainServices[Domain Services]
        CoreExceptions[Core Exceptions]
        CoreLogging[Core Logging]
    end
    
    subgraph EventInfra["Event Infrastructure"]
        ProtocolBus[Protocol EventBus]
        Handlers
        Transports
    end
    
    subgraph External["External Dependencies"]
        Qt[PySide6/Qt]
        HTTP[aiohttp]
        FileSystem[watchdog]
    end
    
    Applications --&gt; UIFramework
    UIFramework --&gt; ClientCore
    UIFramework --&gt; Qt
    
    ClientCore --&gt; APICore
    ClientCore --&gt; Qt
    ClientCore --&gt; FileSystem
    
    APICore --&gt; HTTP
    APICore --&gt; CoreLogging
    APICore --&gt; CoreExceptions
    
    EventInfra -.-&gt;|optional| ClientCore
    Transports --&gt; ProtocolBus
    ProtocolBus --&gt; Handlers
    
    style Applications fill:#e1f5fe
    style UIFramework fill:#e1f5fe
    style ClientCore fill:#fff3e0
    style APICore fill:#f3e5f5
    style EventInfra fill:#e8f5e9
    style External fill:#eceff1
</div><hr>
<h2 id="11-component-communication-matrix">11. Component Communication Matrix </h2>
<table>
<thead>
<tr>
<th>From ↓ To →</th>
<th>UI Layer</th>
<th>Client Service</th>
<th>Application EventBus</th>
<th>API Layer</th>
<th>Protocol EventBus</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>UI Layer</strong></td>
<td>-</td>
<td>IPC calls, Config updates</td>
<td>Subscribe, Publish</td>
<td>Direct calls (degraded mode)</td>
<td>-</td>
</tr>
<tr>
<td><strong>Client Service</strong></td>
<td>-</td>
<td>-</td>
<td>Publish events</td>
<td>Direct calls</td>
<td>Optional: Trigger app events</td>
</tr>
<tr>
<td><strong>Application EventBus</strong></td>
<td>Qt Signals</td>
<td>Qt Signals</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td><strong>API Layer</strong></td>
<td>Return values, Exceptions</td>
<td>Return values, Exceptions</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td><strong>Protocol EventBus</strong></td>
<td>-</td>
<td>Via handlers</td>
<td>Via handlers</td>
<td>-</td>
<td>-</td>
</tr>
</tbody>
</table>
<hr>
<p><strong>Last Updated:</strong> February 8, 2026</p>

      </div>
      <div class="md-sidebar-toc">
<div class="md-toc">
<details style="padding:0;;padding-left:0px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#component-diagrams---api-client-ui-architecture" class="md-toc-link"><p>Component Diagrams - API-Client-UI Architecture</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#1-three-layer-system-architecture" class="md-toc-link">
            <ol>
<li>Three-Layer System Architecture</li>
</ol>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#2-layer-component-view" class="md-toc-link">
            <ol start="2">
<li>Layer Component View</li>
</ol>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#3-class-hierarchy---api-layer" class="md-toc-link">
            <ol start="3">
<li>Class Hierarchy - API Layer</li>
</ol>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#4-class-hierarchy---client-layer" class="md-toc-link">
            <ol start="4">
<li>Class Hierarchy - Client Layer</li>
</ol>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#5-class-hierarchy---ui-framework" class="md-toc-link">
            <ol start="5">
<li>Class Hierarchy - UI Framework</li>
</ol>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#6-event-system-architecture" class="md-toc-link">
            <ol start="6">
<li>Event System Architecture</li>
</ol>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#7-event-type-hierarchy" class="md-toc-link">
            <ol start="7">
<li>Event Type Hierarchy</li>
</ol>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#8-logging-architecture" class="md-toc-link">
            <ol start="8">
<li>Logging Architecture</li>
</ol>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#9-exception-hierarchy" class="md-toc-link">
            <ol start="9">
<li>Exception Hierarchy</li>
</ol>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#10-dependency-graph" class="md-toc-link">
            <ol start="10">
<li>Dependency Graph</li>
</ol>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#11-component-communication-matrix" class="md-toc-link">
            <ol start="11">
<li>Component Communication Matrix</li>
</ol>

          </a></div>
        </div>
      </details>
    
</div>
</div>
      <a id="sidebar-toc-btn">≡</a>
    
    
    <script type="module">
// TODO: If ZenUML gets integrated into mermaid in the future,
//      we can remove the following lines.


var MERMAID_CONFIG = ({"startOnLoad":false});
if (typeof MERMAID_CONFIG !== 'undefined') {
  MERMAID_CONFIG.startOnLoad = false
  MERMAID_CONFIG.cloneCssStyles = false
  MERMAID_CONFIG.theme = "dark"
}

mermaid.initialize(MERMAID_CONFIG || {})
if (typeof(window['Reveal']) !== 'undefined') {
  function mermaidRevealHelper(event) {
    var currentSlide = event.currentSlide
    var diagrams = currentSlide.querySelectorAll('.mermaid')
    for (var i = 0; i < diagrams.length; i++) {
      var diagram = diagrams[i]
      if (!diagram.hasAttribute('data-processed')) {
        mermaid.init(null, diagram, ()=> {
          Reveal.slide(event.indexh, event.indexv)
        })
      }
    }
  }
  Reveal.addEventListener('slidetransitionend', mermaidRevealHelper)
  Reveal.addEventListener('ready', mermaidRevealHelper)
  await mermaid.run({
    nodes: document.querySelectorAll('.mermaid')
  })
} else {
  await mermaid.run({
    nodes: document.querySelectorAll('.mermaid')
  })
}
</script>
    
    
    
<script>

var sidebarTOCBtn = document.getElementById('sidebar-toc-btn')
sidebarTOCBtn.addEventListener('click', function(event) {
  event.stopPropagation()
  if (document.body.hasAttribute('html-show-sidebar-toc')) {
    document.body.removeAttribute('html-show-sidebar-toc')
  } else {
    document.body.setAttribute('html-show-sidebar-toc', true)
  }
})
</script>
      
  
    </body></html>